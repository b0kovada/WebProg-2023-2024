<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Kurzusok és Diákok Kezelése</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        form, ul { margin-top: 20px; }
        li { margin-bottom: 5px; list-style-type: none; }
        input, button { margin-top: 10px; padding: 10px; }
        button { cursor: pointer; }
        #editStudentForm { background-color: #f0f0f0; padding: 20px; display: block; }
    </style>
</head>
<body>
    <!-- Kurzusok és diákok kezelése itt marad változatlanul -->

    <h2>Diák szerkesztése</h2>
    <form id="editStudentForm">
        <input type="hidden" id="editStudentId">
        <input type="text" id="editStudentName" placeholder="Diák neve" required>
        <button type="submit">Diák módosítása</button>
    </form>

    <script src="scripts.js"></script>
</body>
</html>


document.addEventListener('DOMContentLoaded', function() {
    loadStudents();
    loadCourses();
});

document.getElementById('newStudentForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const studentName = document.getElementById('studentName').value;
    const studentCourse = document.getElementById('studentCourse').value;
    createStudent(studentName, studentCourse);
});

document.getElementById('editStudentForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const studentId = document.getElementById('editStudentId').value;
    const studentName = document.getElementById('editStudentName').value;
    updateStudent(studentId, studentName);
});

function loadStudents() {
    fetch('https://vvri.pythonanywhere.com/api/students')
        .then(response => response.json())
        .then(data => {
            const studentList = document.getElementById('studentList');
            studentList.innerHTML = '';
            data.forEach(student => {
                const li = document.createElement('li');
                li.textContent = `${student.name} (Kurzus ID: ${student.course_id}) `;
                
                const editBtn = document.createElement('button');
                editBtn.textContent = 'Szerkeszt';
                editBtn.onclick = () => showEditStudentForm(student.id, student.name);
                li.appendChild(editBtn);

                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'Törlés';
                deleteBtn.onclick = () => deleteStudent(student.id);
                li.appendChild(deleteBtn);

                studentList.appendChild(li);
            });
        }).catch(error => console.error('Hiba:', error));
}

function showEditStudentForm(studentId, studentName) {
    const form = document.getElementById('editStudentForm');
    form.style.display = 'block';
    document.getElementById('editStudentId').value = studentId;
    document.getElementById('editStudentName').value = studentName;
}

function updateStudent(studentId, studentName) {
    fetch(`https://vvri.pythonanywhere.com/api/students/${studentId}`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ name: studentName })
    }).then(response => {
        if (response.ok) {
            console.log('Diák módosítva.');
            loadStudents();
        } else {
            console.error('Hiba a diák módosítása közben.');
        }
    }).catch(error => console.error('Hiba:', error));
}

function deleteStudent(studentId) {
    fetch(`https://vvri.pythonanywhere.com/api/students/${studentId}`, {
        method: 'DELETE'
    }).then(response => {
        if (response.ok) {
            console.log('Diák törölve.');
            loadStudents();
        } else {
            console.error('Hiba a diák törlése közben.');
        }
    }).catch(error => console.error('Hiba:', error));
}